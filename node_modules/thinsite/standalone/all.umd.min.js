!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(){return j++}function e(t){var n=t.dependents;t.dependents={},t.cache=void 0,Object.keys(n).forEach(function(t){e(n[t])}),t.onInvalidate&&(B?x.push(t.onInvalidate):t.onInvalidate())}function n(t,e,n,i){if(void 0===t)return r();if("string"==typeof e){if(!Object.defineProperty)throw new Error("Object.defineProperty is not supported");return n?Array.isArray(n)?arrayProperty(t,e,n):f(t,e,n,i):u(t,e)}return t instanceof Function?o(t,e):void 0}function r(){var n=function(){return B&&(n.dependents[B.id]=B),n.value};return n.id=t(),n.dependents={},n.get=n,n.set=function(t){n.value!==t&&(Array.isArray(t)&&a(t),n.value=t,e(n))},n}function i(t){return t._reProxy||(t._reProxy=r(),t._reProxy.value=t,t.getValueLocation=function(e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;throw new Error("Position value not found in array")},t.insertBeforeValue=function(e,n){return t.splice(t.getValueLocation(n),0,e)},t.removeValue=function(e){return t.splice(t.getValueLocation(e),1)},["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(n){var r=t[n];t[n]=function(){r.apply(this,arguments),e(t._reProxy)}})),t._reProxy}function o(n,r){var i=function t(){if(B&&(t.dependents[B.id]=B),!t.cache){var e=B;B=t;try{t.cache={value:n()}}catch(t){throw t}B=e}if(!B){var r=x;x=[],r.forEach(function(t){t()})}return t.cache.value};return i.id=t(),i.dependents={},i.get=i,r&&(i.set=function(t){r(t),e(i)}),i}function s(t,e){var n=o(t),r=!0;return n.onInvalidate=function(){r&&(n.get(),e&&e())},n.get(),{cancel:function(){n.onInvalidate=void 0,r=!1}}}function a(t){t._funcNotifiers||(t._funcNotifiers=i(t),["reduce","forEach","map","filter"].forEach(function(e){var n=t[e];t[e]=function(){return t._funcNotifiers.get(),n.apply(t,arguments)}}))}function u(t,e){var n=t[e],i=r();return i.set(n),Object.defineProperty(t,e,i),i}function f(t,e,n,r){var i=o(n,r);return Object.defineProperty(t,e,i),i}function c(t){this.args=t;var e=t[0];if(!(e instanceof Array))throw Error("Invalid bundle call");this.strings=e}function h(){return new c(arguments)}function l(t){if(!t.isComplete()){for(var e,n,r=t.thisChar();" "==r||"\r"==r||"\n"==r;)t.step(),r=t.thisChar();if("/"!=r&&">"!=r){if(void 0===r){var i=t.getStringCursor()-1;return t.step(),i}var o=t.collectStaticsThrough(["="," ","\r","\n","/",">"]);if(o.length>1)throw Error("Complex attribute names are not supported");if(e=o[0],"="==(r=t.thisChar())){if(t.step(),'"'!=(n=t.thisChar())&&"'"!=n)throw Error("Attribute values must be enclosed in \" or '");t.step();var s=t.collectStaticsThrough([n]);return t.step(),function(t){var r=s.map(function(e){return"string"==typeof e?e:t[e+1]});return new F(e,r,n)}}return function(t){return new F(e)}}}}function v(t){for(var e=[],n=!0;void 0!==n;){for(var r=t.thisChar();" "==r||"\r"==r||"\n"==r;)t.step(),r=t.thisChar();"/"!=r&&">"!=r||(n=null),n=l(t),void 0!==n&&e.push(n)}return function(t){return e.map(function(e){return"string"==typeof e?e:e instanceof Function?e(t):t[e+1]})}}function p(t,e,n){this.name=t,this.attributes=e,this.contents=n}function d(t){var e=t.collectStaticsThrough([">","/>"," ","\n","\r"]),n=e[0].substring(1),r=v(t);if("/>"==t.collectStaticsThrough([">","/>"],!0).terminator.string)return function(t){return new p(n,r(t))};var i=w(t),o=t.collectStaticsThrough([">"],!0),s=o[0].substring(2,o[0].length-1);if(s!=n)throw Error("Unexpected closing tag: expecting </"+n+">, found </"+s+">");return function(t){return new p(n,r(t),i(t))}}function m(t){function e(){return t.strings[r]}function n(){for(var e="",n=Math.max(i,0),o=r;o<t.strings.length;o++){for(var s=n;s<t.strings[o].length;s++)e+=t.strings[o][s];n=0}return e}var r=0,i=0;this.getStringCursor=function(){return r},this.thisChar=function(){var t=e();if(t)return t[i]},this.thisItem=function(){return-1==i?t.args[r]:this.thisChar()},this.isComplete=function(){return r>=t.strings.length},this.step=function(){var t=e();return i>=t.length-1?(i=-1,r++):i++,this.thisItem()},this.remainingStrings=n,this.collectStaticsThrough=function(n,o){void 0===o&&(o=!1);var s=[];-1==i&&s.push(r-1);for(var a;!a&&r<t.strings.length;){var u=e();if(n.forEach(function(t){var e=u.indexOf(t,i);e>-1&&(!a||a&&e<a.location)&&(a={location:e,string:t})}),a){var f=a.location;o&&(f+=a.string.length);var c=e().substring(i,f);return c.length>0&&s.push(c),i=f,s.terminator=a,s}var c=e().substring(i);c.length>0&&s.push(c),r<t.args.length-1&&s.push(r),i=0,r++}return s}}function g(t){if(!N[t]){var e=document.createElement("div");e.innerHTML=t,N[t]=e.innerText}return N[t]}function y(t){var e=JSON.stringify(t.strings);if(!R.html[e]){var n=new m(t);R.html[e]=w(n)}return R.html[e](t.args)}function w(t){if(t.isComplete())throw Error("invalid cursor");for(var e=[],n=!1;!t.isComplete()&&!n;){var r=t.collectStaticsThrough(["</","<"]);if(r.forEach(function(t){if("string"==typeof t){var n=t.match(/&(?:[a-z]+|#\d+);/g);n&&n.forEach(function(e){t=t.replace(e,g(e))})}e.push(t)}),r.terminator)if("<"==r.terminator.string){var i=d(t);e.push(i)}else n=!0}return function(t){return e.map(function(e){return"string"==typeof e?e:e instanceof Function?e(t):t[e+1]})}}function b(t,e,n){"string"==typeof e&&(e=document.getElementById(e));var r=new D(void 0,e,n);return r.install(t),r}function E(t){var e=1,n=function t(n){var r=e++;t.dependents[r]=n,t.remove=function(){delete t.dependents[r]}};return n.trigger=function(){var e=arguments;Object.keys(n.dependents).forEach(function(r){n.dependents[r].apply(t,e)})},n.dependents={},n}function C(t){if(!t.onRemove){t.onRemove=E(t),t.onInsert=E(t);var e=t.push;t.push=function(n){var r=e.call(t,n);return t.onInsert.trigger(n,t.length),r};var n=t.pop;t.pop=function(){var e=n.apply(t);return t.onRemove.trigger(t.length-1),e};var r=t.shift;t.shift=function(){var e=r.apply(t);return t.onRemove.trigger(0),e};var i=t.unshift;t.unshift=function(e){var n=i.call(t,e);return t.onRemove.trigger(e,0),n};var o=t.splice;t.splice=function(e,n){e=e.valueOf();for(var r=o.apply(t,arguments);n>0;)t.onRemove.trigger(e+n-1),n--;for(var i=2;i<arguments.length;i++){var s=arguments[i];t.onInsert.trigger(s,e+i-2)}return r}}}function k(t,e){function n(e){var n=function(){for(var n=0;n<t.length;n++)if(e===t[n])return n};return n.valueOf=n,n}for(var r=[],i=0;i<t.length;i++){var o=t[i],s=e(o,n(o),t);r.push(s)}return C(t),t.onRemove(function(t){return r.splice(t,1)}),t.onInsert(function(i,o){var s=e(i,n(i),t);return r.splice(o,0,s)}),r}function A(t){C(t);var e=!1,n=[];return function(r,i){e||(e=!0,t.onRemove(function(t){n[t].remove(),n.splice(t,1)}),t.onInsert(function(t,e){var o,s=n[e];o=s?s.insertContent(t):i.installChild(t,r),n.splice(e,0,o)}),t.forEach(function(t){var e=i.installChild(t,r);n.push(e)}))}}function O(t,e){return A(k(t,e))}var B,j=0,x=[],P=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},S=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},I=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},T=function(){function t(e){P(this,t),this.parent=e}return S(t,[{key:"appendChild",value:function(e){return e?e.parent=this:e=new t(this),this.last&&(this.last.itemAfter=e),e.itemBefore=this.last,this.last=e,this.first||(this.first=e),e}},{key:"insert",value:function(e){return e=e||new t(this.parent),e.itemBefore=this.itemBefore,e.itemAfter=this,this.itemBefore&&(this.itemBefore.itemAfter=e),this.itemBefore=e,e}},{key:"remove",value:function(){if(this.parent){var t=this.itemBefore,e=this.itemAfter;this.itemBefore&&(this.itemBefore.itemAfter=e),this.itemAfter&&(this.itemAfter.itemBefore=t),this.parent.first===this&&(this.parent.first=e),this.parent.last===this&&(this.parent.last=t),this.wasAfter=t,this.wasBefore=e,this.itemBefore=null,this.itemAfter=null}}},{key:"forEach",value:function(t,e){for(var n=this.first;n;){var r=n.itemAfter;t.call(e,n),n=r}}}]),t}(),F=function(){function t(e,n,r){P(this,t),this.name=e,this.value=n,this.bounder=r}return S(t,[{key:"evaluate",value:function(t,e){if(!(e instanceof Object))return e;if(Array.isArray(e))return e.map(function(e){return this.evaluate(t,e)},this).join("");if(!(e instanceof c)){if(e instanceof Function){var n=e(t);return this.evaluate(t,n)}return e.toString()}}},{key:"getName",value:function(t){return this.evaluate(t,this.name)}},{key:"getValue",value:function(t){return this.evaluate(t,this.value)}}]),t}(),N={},R={html:{}},L=function(){function t(e,n,r){if(P(this,t),!(e instanceof Element))throw Error("Invalid location host");this.host=e,this.parent=n,this.index=r}return S(t,[{key:"createChild",value:function(){}},{key:"clear",value:function(){}},{key:"install",value:function(t){var e=this;Array.isArray(t)?t.forEach(function(t){this.install(t)},this):t instanceof Function?this.updater=s(function(){var n=t(e.host);e.install(n)}):t instanceof F&&(this.updater=s(function(){var n=t.getName(e.host);n&&n.length>0&&e.host.setAttribute(n,t.getValue(e.host))}))}},{key:"remove",value:function(){this.updater&&this.updater.cancel()}}]),t}(),D=function(t){function e(t,n,r,i){P(this,e);var o=I(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.host=n,o.namespace=i,o.comesBefore=r,r||t||(o.fallbackEnder=document.createComment("html location ender "+o.host.nodeName),o.host.appendChild(o.fallbackEnder)),o}return _(e,t),S(e,[{key:"getFirstElement",value:function(){if(this.ele)return this.ele;for(var t=this.first;t;){if(t.host!==this.host)throw Error("unexpected child host - cannot remove if statement");var e=t.getFirstElement();if(e)return e;t=t.itemAfter}}},{key:"getElementAfter",value:function(){if(this.comesBefore)return this.comesBefore;for(var t=this.itemAfter;t;){if(t.host!==this.host)throw Error("unexpected child host - cannot remove if statement");var e=t.getFirstElement();if(e)return e;t=t.itemAfter}return this.parent&&this.parent.host===this.host?this.parent.getElementAfter():this.fallbackEnder}},{key:"createChild",value:function(t,n){var r=new e(this,t,void 0,n);return this.appendChild(r),r}},{key:"installChild",value:function(t,e,n){var r=this.createChild(e,n);return r.install(t),r}},{key:"insertContent",value:function(t){var n=this.parent?this.parent.namespace:void 0,r=new e(this.parent,this.host,n);return this.insert(r),r.install(t),r}},{key:"install",value:function(t){var e=this;if(this.clear(),this.installedContent=t,void 0===t||null===t);else if(t instanceof Object)if(Array.isArray(t))for(var n=0;n<t.length;n++)this.installChild(t[n],this.host,this.namespace);else if(t instanceof c)for(var r=y(t),n=0;n<r.length;n++)this.installChild(r[n],this.host,this.namespace);else if(t instanceof p){var i=this.namespace||"svg"===t.name?"http://www.w3.org/2000/svg":void 0;if(this.ele=i?document.createElementNS(i,t.name):document.createElement(t.name),t.attributes){var o=new L(this.ele);o.install(t.attributes)}if(t.contents&&this.installChild(t.contents,this.ele,i),!this.ele)throw new Error("Content creation triggered its own removal");this.host.insertBefore(this.ele,this.getElementAfter())}else if(t instanceof Element){var a=t.parentElement;a&&(console.log("Element removed from one location and placed in another by install (DOM elements cannot be in multiple places at once)"),a.removeChild(t)),this.ele=t,this.host.insertBefore(this.ele,this.getElementAfter())}else if(t instanceof Function){var u,f=this.createChild(this.host,this.namespace),h=function(){return f.install(u)},l=this;this.updater=s(function(){u=t(l.host,l)},h),h()}else if(t&&t.then instanceof Function)t.then(function(t){return e.installChild(t,e.host,e.namespace)},console.error);else if(t&&t.toContent instanceof Function){var v=t.toContent();this.installChild(v,this.host,this.namespace)}else this.ele=document.createTextNode(t.toString()),this.host.insertBefore(this.ele,this.getElementAfter()),console.log("Unexpected content type - using toString");else this.ele=document.createTextNode(t),this.host.insertBefore(this.ele,this.getElementAfter());this.occupant=t}},{key:"clear",value:function(){if(this.hasBeenRemoved)throw Error("already removed");this.updater&&this.updater.cancel(),this.forEach(function(t){t.remove()}),this.ele?(this.host.removeChild(this.ele),this.ele=null):this.installedContent&&(this.clearedAgain=!0)}},{key:"remove",value:function(){this.clear(),T.prototype.remove.call(this),this.hasBeenRemoved=!0,this.fallbackEnder&&this.host.removeChild(this.fallbackEnder)}}]),e}(T),V=function(){function t(t,e){return function(n){return n.addEventListener(t,e)}}function e(t,e){function r(t,n){s.forEach(function(r){t[r]=function(t){return e(function(e){n&&!n(e)||String.fromCharCode(e.which).toLowerCase()!==r||(e.preventDefault(),t(e))})}})}function i(t,i){n(e,t,function(){var t=function(t){return e(function(e){a[keyName]===e.which&&(e.preventDefault(),t(e))})};return r(t,i),t})}if(!s){s=[];for(var o=0;o<230;o++){var u=String.fromCharCode(o);""!=u.length&&s.push(u)}}a||(a={backspace:8,tab:9,enter:13,pause:19,capsLock:20,escape:27,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,leftWindow:91,rightWindow:92,select:93,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145}),Object.keys(a).forEach(function(t){e[t]=function(n){return e(function(e){a[t]===e.which&&(e.preventDefault(),n(e))})}}),r(e),i("ctrl",function(t){return t.ctrlKey||t.metaKey}),i("shift",function(t){return t.shiftKey}),i("alt",function(t){return t.altKey})}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var r=n.apply(this);return Object.defineProperty(t,e,{enumerable:!0,configurable:!0,value:r}),r}}):t[e]=n.apply(t)}for(var r=["click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","abort","load","scroll","blur","change","focus","focusin","focusout","input","invalid","reset","search","select","submit","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","copy","cut","paste","animationend","animationiteration","animationstart","transitionend","show","toggle","wheel"],i=0;i<r.length;i++){var o=r[i];t[o]=function(t){return function(e){return function(n){return n.addEventListener(t,e)}}}(o)}t.wheel.down=function(e){return t.wheel(function(t){t.preventDefault(),t.wheelDelta<0&&e(t)})},t.wheel.up=function(e){return t.wheel(function(t){t.preventDefault(),t.wheelDelta>0&&e(t)})};var s,a;return["keydown","keyup","keypress"].forEach(function(r){n(t,r,function(){var n=function(e){return t(r,e)};return e(r,n),n})}),t}(),K=Object.freeze({obs:n,install:b,bundle:h,on:V,map:O}),M=n;Object.keys(K).forEach(function(t){return M[t]=K[t]}),window.ts=M});
