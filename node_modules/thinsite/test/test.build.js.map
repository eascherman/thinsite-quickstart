{"version":3,"file":"test.build.js","sources":["../changedetection.js","../locations/linkedtree.js","../bundle.js","../compiler/attribute.js","../compiler/attributes.js","../compiler/element.js","../compiler/cursor.js","../compiler/html.js","../locations/attributelocation.js","../locations/htmllocation.js","../templateengine.js","../on.js","../arrayhandling.js","test.js"],"sourcesContent":["\r\nvar counter = 0;\r\nfunction newId() {\r\n    return counter++;\r\n}\r\n\r\nexport function invalidate(obj) {\r\n    var deps = obj.dependents;\r\n    obj.dependents = {};\r\n    obj.cache = undefined;\r\n    Object.keys(deps).forEach(function(key) {\r\n        invalidate(deps[key]);\r\n    });\r\n    if (obj.onInvalidate) {\r\n        if (currentDependent)\r\n            onInvalidateQueue.push(obj.onInvalidate);\r\n        else\r\n            obj.onInvalidate();\r\n    }\r\n}\r\n\r\n\r\nexport default function re(arg1, arg2, arg3, arg4) {\r\n    if (arg1 === undefined)\r\n        return getterSetter();\r\n    else if (typeof arg2 === 'string') {\r\n        if (!Object.defineProperty)\r\n            throw new Error('Object.defineProperty is not supported');\r\n        if (arg3) {\r\n            if (Array.isArray(arg3))\r\n                return arrayProperty(arg1, arg2, arg3);\r\n            else\r\n                return relativeProperty(arg1, arg2, arg3, arg4);\r\n        } else\r\n            return alerterProperty(arg1, arg2);\r\n    } else if (arg1 instanceof Function)\r\n        return relativeGetterSetter(arg1, arg2);\r\n};\r\n\r\n\r\n\r\n\r\n\r\nvar currentDependent;\r\nvar onInvalidateQueue = [];\r\n\r\n// a getterSetter that detects array changes\r\nexport function getterSetter() {\r\n    // var out = {\r\n    //     id: newId(),\r\n    //     dependents: {},\r\n    //     get: function get() {\r\n    //         if (currentDependent)\r\n    //             out.dependents[currentDependent.id] = currentDependent;\r\n\r\n    //         return out.value;\r\n    //     },\r\n    //     set: function set(value) {\r\n    //         if (out.value !== value) {\r\n    //             if (Array.isArray(value))\r\n    //                 arrayFuncNotifiers(value);\r\n    //             out.value = value;\r\n    //             invalidate(out);\r\n    //         } \r\n    //     }\r\n    // };\r\n    var out = function get() {\r\n        if (currentDependent)\r\n            out.dependents[currentDependent.id] = currentDependent;\r\n\r\n        return out.value;\r\n    };\r\n    out.id = newId();\r\n    out.dependents = {};\r\n    out.get = out;\r\n    out.set = function set(value) {\r\n        if (out.value !== value) {\r\n            if (Array.isArray(value))\r\n                arrayFuncNotifiers(value);\r\n            out.value = value;\r\n            invalidate(out);\r\n        } \r\n    };\r\n\r\n    return out;\r\n};\r\n\r\n\r\nexport function arrayGetterSetter(arr) {\r\n    if (!arr._reProxy) {     // proxy array modifiers so changes can be noted\r\n        arr._reProxy =  getterSetter();  \r\n        arr._reProxy.value = arr;\r\n\r\n        arr.getValueLocation = function getValueLocation(value) {\r\n            for (var i=0; i<arr.length; i++) \r\n                if (arr[i] === value)\r\n                    return i;\r\n            throw new Error('Position value not found in array');\r\n        };\r\n\r\n        arr.insertBeforeValue = function insertBeforeValue(item, positionValue) {\r\n            return arr.splice(arr.getValueLocation(positionValue), 0, item);\r\n        };\r\n\r\n        arr.removeValue = function removeValue(item) {\r\n            return arr.splice(arr.getValueLocation(item), 1);\r\n        };\r\n\r\n        ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']\r\n            .forEach(function(method) {\r\n                var func = arr[method];\r\n                arr[method] = function() {\r\n                    func.apply(this, arguments);\r\n                    invalidate(arr._reProxy);\r\n                };\r\n            });\r\n    }\r\n    return arr._reProxy;\r\n};\r\n\r\n\r\nexport function relativeGetterSetter(getter, setter) {\r\n    // var out = {\r\n    //     id: newId(),\r\n    //     dependents: {},\r\n    //     get: function get() {\r\n    //         if (currentDependent)\r\n    //             out.dependents[currentDependent.id] = currentDependent;\r\n    //         // use the getter if there's no valid cache\r\n    //         if (!out.cache) {\r\n    //             var oldDependent = currentDependent;\r\n    //             currentDependent = out;\r\n    //             try {\r\n    //                 out.cache = {value: getter()};\r\n    //             } catch (err) { \r\n    //                 throw err;\r\n    //             }\r\n    //             currentDependent = oldDependent;   \r\n    //         }\r\n    //         // if this is the root call, process any outstanding onInvalidate callbacks\r\n    //         if (!currentDependent) {\r\n    //             var queue = onInvalidateQueue;\r\n    //             onInvalidateQueue = [];\r\n    //             queue.forEach(function(func) {\r\n    //                 func();\r\n    //             })\r\n    //         }\r\n    //         return out.cache.value;\r\n    //     }\r\n    // };\r\n    \r\n    var out = function get() {\r\n        if (currentDependent)\r\n            get.dependents[currentDependent.id] = currentDependent;\r\n        // use the getter if there's no valid cache\r\n        if (!get.cache) {\r\n            var oldDependent = currentDependent;\r\n            currentDependent = get;\r\n            try {\r\n                get.cache = {value: getter()};\r\n            } catch (err) { \r\n                throw err;\r\n            }\r\n            currentDependent = oldDependent;   \r\n        }\r\n        // if this is the root call, process any outstanding onInvalidate callbacks\r\n        if (!currentDependent) {\r\n            var queue = onInvalidateQueue;\r\n            onInvalidateQueue = [];\r\n            queue.forEach(function(func) {\r\n                func();\r\n            })\r\n        }\r\n        return get.cache.value;\r\n    };\r\n    out.id = newId();\r\n    out.dependents = {};\r\n    out.get = out;\r\n    \r\n    if (setter)\r\n        out.set = function set(value) {\r\n            setter(value);\r\n            invalidate(out);\r\n        };\r\n    \r\n    return out;\r\n};\r\n\r\n\r\nexport function onChange(trigger, callback) {\r\n    var gs = relativeGetterSetter(trigger);\r\n    var continues = true;\r\n    gs.onInvalidate = function onChangeCallback() {\r\n        if (continues) {\r\n            gs.get();\r\n            if (callback)\r\n                callback();\r\n        }\r\n    };\r\n    gs.get();\r\n    return {\r\n        cancel: function cancelOnChange() {\r\n            gs.onInvalidate = undefined;\r\n            continues = false;\r\n        }\r\n    };   \r\n};\r\n\r\n\r\nexport function arrayFuncNotifiers(arr) {\r\n    if (!arr._funcNotifiers) {\r\n        arr._funcNotifiers = arrayGetterSetter(arr);\r\n\r\n        ['reduce', 'forEach', 'map', 'filter']\r\n            .forEach(function(fName) {\r\n                var func = arr[fName];\r\n                arr[fName] = function() {\r\n                    arr._funcNotifiers.get();\r\n                    return func.apply(arr, arguments);\r\n                };\r\n            });\r\n    }\r\n};\r\n\r\n\r\nexport function alerterProperty(obj, prop) {\r\n    var value = obj[prop];\r\n    var gs = getterSetter();\r\n    gs.set(value);\r\n    Object.defineProperty(obj, prop, gs);\r\n    return gs;\r\n};\r\n\r\n\r\nexport function relativeProperty(obj, prop, getter, setter) {\r\n    var gs = relativeGetterSetter(getter, setter);\r\n    Object.defineProperty(obj, prop, gs);\r\n    return gs;\r\n};\r\n","\r\n// liked a linked list but it can have a tree of children as well\r\n// used to manage locations of content in the DOM\r\n\r\nexport default class LinkedTree {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    appendChild(lt) {\r\n        if (!lt)\r\n            lt = new LinkedTree(this);\r\n        else\r\n            lt.parent = this;\r\n        if (this.last)\r\n            this.last.itemAfter = lt;\r\n        lt.itemBefore = this.last;\r\n        this.last = lt;\r\n        if (!this.first)\r\n            this.first = lt;\r\n        \r\n        return lt;\r\n    }\r\n\r\n    insert(lt) {\r\n        lt = lt || new LinkedTree(this.parent);\r\n        lt.itemBefore = this.itemBefore;\r\n        lt.itemAfter = this;\r\n        if (this.itemBefore)\r\n            this.itemBefore.itemAfter = lt;\r\n        this.itemBefore = lt;\r\n        \r\n        return lt;\r\n    }\r\n\r\n    remove() {\r\n        if (!this.parent) return;\r\n        \r\n        var itemBefore = this.itemBefore;\r\n        var itemAfter = this.itemAfter;\r\n        if (this.itemBefore)\r\n            this.itemBefore.itemAfter = itemAfter;\r\n        if (this.itemAfter)\r\n            this.itemAfter.itemBefore = itemBefore;\r\n        if (this.parent.first === this)\r\n            this.parent.first = itemAfter;\r\n        if (this.parent.last === this)\r\n            this.parent.last = itemBefore;\r\n        \r\n        this.wasAfter = itemBefore;\r\n        this.wasBefore = itemAfter;\r\n        this.itemBefore = null;\r\n        this.itemAfter = null;\r\n    }\r\n\r\n    forEach(func, thiz) {\r\n        var child = this.first;\r\n        while (child) {\r\n            var next = child.itemAfter;     // retrieve first in case func affects it\r\n            func.call(thiz, child);\r\n            child = next;\r\n        }\r\n    }\r\n}","\r\nexport function Bundle(args) {\r\n    this.args = args;\r\n    var strings = args[0];\r\n    if (!(strings instanceof Array))\r\n        throw Error('Invalid bundle call');\r\n    this.strings = strings;\r\n}\r\n\r\nexport default function bundle() {\r\n    return new Bundle(arguments);\r\n}","\r\nimport {Bundle} from '../bundle.js';\r\n\r\n\r\nexport class CompiledHtmlAttribute {\r\n    constructor(name, value, bounder) {\r\n        this.name = name;\r\n        this.value = value;\r\n        this.bounder = bounder;\r\n    }\r\n\r\n    evaluate(host, obj) {\r\n        if (!(obj instanceof Object)) {\r\n            return obj;\r\n        } else if (Array.isArray(obj)) {\r\n            return obj.map(function(o) { \r\n                return this.evaluate(host, o); \r\n            }, this).join('');\r\n        } else if (obj instanceof Bundle) {\r\n            // todo: fill\r\n        } else if (obj instanceof Function) {\r\n            var result = obj(host);\r\n            return this.evaluate(host, result);\r\n        } else {\r\n            return obj.toString();\r\n        }\r\n    }\r\n\r\n    getName(host) {\r\n        return this.evaluate(host, this.name);\r\n    }\r\n\r\n    getValue(host) {\r\n        return this.evaluate(host, this.value);\r\n    }\r\n}\r\n\r\n\r\nexport default function compileAttribute(cursor) {\r\n    if (cursor.isComplete())\r\n        return undefined;\r\n    \r\n    var attrName;\r\n    var attrBounder;\r\n    \r\n    var tc = cursor.thisChar();    \r\n    \r\n    // move through white space\r\n    while (tc == ' ' || tc == '\\r' || tc == '\\n') {\r\n        cursor.step();\r\n        tc = cursor.thisChar();\r\n    }\r\n        \r\n    // bail if there's nothing here (end of tag reached)\r\n    if (tc == '/' || tc == '>') \r\n        return undefined;\r\n        \r\n    if (tc === undefined) {\r\n        var valueLoc = cursor.getStringCursor() - 1;\r\n        //var valueLoc = stringCursor - 1;\r\n        cursor.step();\r\n        return valueLoc;\r\n    } else {\r\n        var nameCollection = cursor.collectStaticsThrough(['=', ' ', '\\r', '\\n', '/', '>']);\r\n        if (nameCollection.length > 1)      // todo: may be able to relax this limitation\r\n            throw Error('Complex attribute names are not supported');\r\n        attrName = nameCollection[0];\r\n    }\r\n    \r\n    // determine attr value, if it exists\r\n    tc = cursor.thisChar();\r\n    if (tc == '=') {\r\n        cursor.step();\r\n        attrBounder = cursor.thisChar();\r\n        if (attrBounder != '\"' && attrBounder != \"'\")\r\n            throw Error('Attribute values must be enclosed in \" or \\'');\r\n        cursor.step();\r\n        \r\n        var staticsCollection = cursor.collectStaticsThrough([attrBounder]);\r\n        cursor.step();      // move past closing attrBounder\r\n        \r\n        return function(args) {\r\n            var attrValue = staticsCollection.map(function(item) {\r\n                if (typeof item == 'string')\r\n                    return item;        // number is a value index\r\n                else\r\n                    return args[item + 1];                // string is plain markup\r\n            });\r\n            return new CompiledHtmlAttribute(attrName, attrValue, attrBounder);\r\n        };\r\n    } else {\r\n        return function(args) {\r\n            return new CompiledHtmlAttribute(attrName);\r\n        }\r\n    }\r\n    \r\n    \r\n\r\n}\r\n","\r\nimport compileAttribute from './attribute.js';\r\n\r\n\r\nexport default function compileAttributes(cursor) {\r\n    var attrs = [];\r\n    \r\n    var ca = true;\r\n    while(ca !== undefined) {\r\n        var tc = cursor.thisChar();\r\n        \r\n        // move through white space\r\n        while (tc == ' ' || tc == '\\r' || tc == '\\n') {\r\n            cursor.step();\r\n            tc = cursor.thisChar();\r\n        }\r\n            \r\n        // bail if there's nothing here (end of tag reached)\r\n        if (tc == '/' || tc == '>') \r\n            ca = null;\r\n            \r\n        ca = compileAttribute(cursor);\r\n        if (ca !== undefined) {\r\n            attrs.push(ca);\r\n        }\r\n    }\r\n    \r\n    return function(args) {\r\n        return attrs.map(function(attr) {\r\n            if (typeof attr == 'string')\r\n                return attr;\r\n            else if (attr instanceof Function)\r\n                return attr(args);\r\n            else\r\n                return args[attr + 1];\r\n        });\r\n    };\r\n}","\r\nimport compileAttributes from './attributes.js';\r\nimport {compileHtml} from './html.js';\r\n\r\n\r\nexport function CompiledHtmlElement(name, attributes, contents) {\r\n    this.name = name;\r\n    this.attributes = attributes;\r\n    this.contents = contents;\r\n}\r\n\r\nexport default function compileElement(cursor) {\r\n    var tagStart = cursor.collectStaticsThrough(['>', '/>', ' ', '\\n', '\\r']);\r\n    var tagName = tagStart[0].substring(1);\r\n    var tagAttrs = compileAttributes(cursor);\r\n    var tagEnding = cursor.collectStaticsThrough(['>', '/>'], true);\r\n    \r\n    if (tagEnding.terminator.string == '/>') {\r\n        return function(args) {\r\n            return new CompiledHtmlElement(tagName, tagAttrs(args));\r\n        };\r\n    }  else {\r\n        var innards = compileHtml(cursor);\r\n        var closeTag = cursor.collectStaticsThrough(['>'], true);\r\n        var closeTagName = closeTag[0].substring(2, closeTag[0].length - 1); \r\n        if (closeTagName != tagName)\r\n            throw Error('Unexpected closing tag: expecting </' + tagName + '>, found </' + closeTagName + '>');\r\n        return function(args) {\r\n            return new CompiledHtmlElement(tagName, tagAttrs(args), innards(args));\r\n        };\r\n    }\r\n}\r\n","\r\n\r\nexport default function Cursor(b) {\r\n    var stringCursor = 0;\r\n    var charCursor = 0;\r\n\r\n    this.getStringCursor = function() {\r\n        return stringCursor;\r\n    };\r\n\r\n    function thisString() {\r\n        return b.strings[stringCursor];\r\n    }\r\n\r\n    this.thisChar = function() {\r\n        var ts = thisString();\r\n        if (!ts)\r\n            return undefined;\r\n        return ts[charCursor];\r\n    };\r\n    \r\n    this.thisItem = function() {\r\n        if (charCursor == -1)\r\n            return b.args[stringCursor];\r\n        else\r\n            return this.thisChar();\r\n    };\r\n    \r\n    this.isComplete = function() {\r\n        return stringCursor >= b.strings.length;\r\n    };\r\n    \r\n    this.step = function() {\r\n        // increment cursor positions\r\n        var ts = thisString();\r\n        if (charCursor >= ts.length - 1) {\r\n            charCursor = -1;\r\n            stringCursor++;\r\n        } else\r\n            charCursor++;\r\n            \r\n        // return the new current item\r\n        return this.thisItem();\r\n    }\r\n\r\n    function remainingStrings() {\r\n        var out = '';\r\n        var cc = Math.max(charCursor, 0);\r\n        for (var i = stringCursor ; i < b.strings.length ; i++) {\r\n            for (var j = cc ; j < b.strings[i].length ; j++)\r\n                out += b.strings[i][j];\r\n            cc = 0;\r\n        }\r\n        return out;\r\n    }\r\n    this.remainingStrings = remainingStrings;\r\n    \r\n    this.collectStaticsThrough = function(terminators, includeTerminator) {\r\n        var rs = remainingStrings;\r\n        if (includeTerminator === undefined)\r\n            includeTerminator = false;\r\n        var out = [];\r\n        if (charCursor == -1)\r\n            out.push(stringCursor - 1);\r\n        var firstTerminator;\r\n        while (!firstTerminator && stringCursor < b.strings.length) {\r\n            var ts = thisString();\r\n            terminators.forEach(function (t) {\r\n                var loc = ts.indexOf(t, charCursor);\r\n                if (loc > -1 && (!firstTerminator || (firstTerminator && loc < firstTerminator.location)))\r\n                    firstTerminator = {\r\n                        location: loc,\r\n                        string: t\r\n                    };\r\n            });\r\n            if (firstTerminator) {\r\n                var finalChar = firstTerminator.location;\r\n                if (includeTerminator)\r\n                    finalChar += firstTerminator.string.length;\r\n                var piece = thisString().substring(charCursor, finalChar);\r\n                if (piece.length > 0)\r\n                    out.push(piece);\r\n                charCursor = finalChar;\r\n                out.terminator = firstTerminator;\r\n                return out;\r\n            } else {\r\n                var piece = thisString().substring(charCursor);\r\n                if (piece.length > 0)\r\n                    out.push(piece);\r\n                if (stringCursor < b.args.length - 1)\r\n                    out.push(stringCursor);\r\n                charCursor = 0;\r\n                stringCursor++;\r\n            }\r\n        }\r\n        return out;\r\n    };\r\n}\r\n","\r\nimport compileElement from './element.js';\r\nimport Cursor from './cursor.js';\r\n\r\n\r\nvar charCodes = {};\r\nfunction charFromHtmlCode(code) {\r\n    if (!charCodes[code]) {\r\n        var ele = document.createElement('div');\r\n        ele.innerHTML = code;\r\n        charCodes[code] = ele.innerText;\r\n    }\r\n    return charCodes[code];\r\n}\r\n\r\nvar compiledBundles = { \r\n    html: {}\r\n};\r\n\r\n\r\nexport default function getCompiledHtmlBundle(b) {\r\n    var sig = JSON.stringify(b.strings);\r\n    if (!compiledBundles.html[sig]) {\r\n        var cursor = new Cursor(b);\r\n        compiledBundles.html[sig] = compileHtml(cursor);\r\n    }\r\n    return compiledBundles.html[sig](b.args);\r\n}\r\n\r\n\r\nexport function compileHtml(cursor) {\r\n    if (cursor.isComplete())\r\n        throw Error('invalid cursor');\r\n                    \r\n    var nodes = [];\r\n\r\n    var externalEndingDetected = false;\r\n    while (!cursor.isComplete() && !externalEndingDetected) {\r\n        var simpleNodes = cursor.collectStaticsThrough(['</', '<']);       // get any text up until the first open or close tag\r\n        simpleNodes.forEach(function(n) {    // add any plain text to the nodes output\r\n            if (typeof n === 'string') {\r\n                var matches = n.match(/&(?:[a-z]+|#\\d+);/g);\r\n                if (matches)\r\n                    matches.forEach(function(match) {\r\n                        n = n.replace(match, charFromHtmlCode(match));\r\n                    });\r\n            }\r\n            nodes.push(n); \r\n        }); \r\n        if (simpleNodes.terminator) {\r\n            if (simpleNodes.terminator.string == '<') {    // internal tag beginning\r\n                var ele = compileElement(cursor);\r\n                nodes.push(ele);\r\n            } else {\r\n                externalEndingDetected = true;\r\n                //cursor.collectStaticsThrough(['>'], true);\r\n            }\r\n        } \r\n    }\r\n\r\n    return function(args) {\r\n        return nodes.map(function(node) {\r\n            if (typeof node == 'string') {\r\n                return node;\r\n            } else if (node instanceof Function) {\r\n                return node(args);\r\n            } else {\r\n                return args[node + 1];\r\n            }\r\n        });\r\n    };\r\n}","\r\nimport {CompiledHtmlAttribute} from '../compiler/attribute.js';\r\nimport {onChange} from '../changedetection.js';\r\n\r\n\r\nexport default class AttributeLocation {\r\n    constructor(host, parent, index) {\r\n        if (!(host instanceof Element))\r\n            throw Error('Invalid location host');\r\n            \r\n        this.host = host;\r\n        this.parent = parent;\r\n        this.index = index;\r\n    }\r\n\r\n    createChild() {}\r\n\r\n    clear() {}\r\n\r\n    install(obj) {\r\n        var thiz = this;\r\n        if (Array.isArray(obj)) {\r\n            obj.forEach(function(o) {\r\n                this.install(o);\r\n            }, this);\r\n        } else if (obj instanceof Function) {\r\n            // todo: add cancellation, this is likely a memory leak\r\n            this.updater = onChange(function() {\r\n                var val = obj(thiz.host);\r\n                thiz.install(val);\r\n            });\r\n        } else if (obj instanceof CompiledHtmlAttribute) {\r\n            this.updater = onChange(function() {\r\n                var name = obj.getName(thiz.host);\r\n                if (name && name.length > 0) \r\n                    thiz.host.setAttribute(name, obj.getValue(thiz.host));\r\n            });\r\n        } \r\n    }\r\n\r\n    remove() {\r\n        if (this.updater)\r\n            this.updater.cancel();\r\n    };\r\n}","\r\nimport LinkedTree from './linkedtree.js';\r\nimport getCompiledHtmlBundle from '../compiler/html.js';\r\nimport AttributeLocation from './attributelocation.js';\r\nimport {CompiledHtmlElement} from '../compiler/element.js';\r\nimport {Bundle} from '../bundle.js';\r\nimport {onChange} from '../changedetection.js';\r\n\r\n\r\nexport default class HtmlLocation extends LinkedTree {\r\n    constructor(parent, host, before, namespace) {\r\n        super(parent);      // may not be right?\r\n        this.host = host;\r\n        this.namespace = namespace;\r\n        this.comesBefore = before;\r\n        \r\n        if (!before && !parent) {\r\n            this.fallbackEnder = document.createComment('html location ender ' + this.host.nodeName);\r\n            this.host.appendChild(this.fallbackEnder);\r\n        }\r\n    }\r\n\r\n    getFirstElement() {\r\n        if (this.ele)\r\n            return this.ele;\r\n        var child = this.first;\r\n        while (child) {\r\n            if (child.host === this.host) {\r\n                var fe = child.getFirstElement();\r\n                if (fe)\r\n                    return fe;\r\n            } else\r\n                throw Error('unexpected child host - cannot remove if statement');\r\n            child = child.itemAfter;\r\n        }\r\n    }\r\n\r\n    getElementAfter() {\r\n        //var ele = (function() {\r\n            if (this.comesBefore)\r\n                return this.comesBefore;\r\n            var sibling = this.itemAfter;\r\n            while (sibling) {\r\n                if (sibling.host === this.host) {\r\n                    var fe = sibling.getFirstElement();\r\n                    if (fe)\r\n                        return fe;\r\n                } else\r\n                    throw Error('unexpected child host - cannot remove if statement');\r\n                sibling = sibling.itemAfter;\r\n            }\r\n            if (this.parent && this.parent.host === this.host)\r\n                return this.parent.getElementAfter();\r\n            return this.fallbackEnder;\r\n        //}).apply(this);\r\n        //if (!ele || ele.parentNode != this.host)\r\n        //    throw new Error('Invalid parent node!');\r\n        //else\r\n        //    return ele;\r\n    }\r\n\r\n    createChild(host, namespace) {\r\n        var loc = new HtmlLocation(this, host, undefined, namespace); \r\n        this.appendChild(loc);\r\n        return loc;\r\n    }\r\n\r\n    installChild(content, host, namespace) {\r\n        var loc = this.createChild(host, namespace);\r\n        loc.install(content);\r\n        return loc;\r\n    }\r\n\r\n    insertContent(content) {\r\n        var ns = this.parent ? this.parent.namespace : undefined;\r\n        var loc = new HtmlLocation(this.parent, this.host, ns);\r\n        this.insert(loc);\r\n        loc.install(content);\r\n        return loc;\r\n    }\r\n\r\n    install(obj) {      // installs the input item in this location\r\n        this.clear();\r\n        this.installedContent = obj;        // todo: remove - testing\r\n        \r\n        if (obj === undefined || obj === null) {\r\n            // do nothing\r\n        } else if (!(obj instanceof Object)) {\r\n            this.ele = document.createTextNode(obj);\r\n            this.host.insertBefore(this.ele, this.getElementAfter());\r\n        } else if (Array.isArray(obj)) {\r\n            for (var i=0; i<obj.length; i++) {\r\n                this.installChild(obj[i], this.host, this.namespace);\r\n            }\r\n        } else if (obj instanceof Bundle) {\r\n            var chtml = getCompiledHtmlBundle(obj);\r\n            for (var i=0; i<chtml.length; i++) {\r\n                this.installChild(chtml[i], this.host, this.namespace);\r\n            }\r\n        } else if (obj instanceof CompiledHtmlElement) {\r\n            var ns = this.namespace || obj.name === 'svg' ? 'http://www.w3.org/2000/svg' : undefined; \r\n            if (ns)\r\n                this.ele = document.createElementNS(ns, obj.name);\r\n            else\r\n                this.ele = document.createElement(obj.name);\r\n            if (obj.attributes) {\r\n                var attrsLocation = new AttributeLocation(this.ele);\r\n                attrsLocation.install(obj.attributes);\r\n            }\r\n            if (obj.contents) {\r\n                this.installChild(obj.contents, this.ele, ns);\r\n            }\r\n            if (!this.ele) \r\n                throw new Error('Content creation triggered its own removal');\r\n            this.host.insertBefore(this.ele, this.getElementAfter());\r\n        } else if (obj instanceof Element) { \r\n            var parent = obj.parentElement;\r\n            if (parent) {\r\n                console.log('Element removed from one location and placed in another by install (DOM elements cannot be in multiple places at once)');\r\n                parent.removeChild(obj);\r\n            }\r\n            this.ele = obj;\r\n            this.host.insertBefore(this.ele, this.getElementAfter());\r\n        } else if (obj instanceof Function) {\r\n            var subLocation = this.createChild(this.host, this.namespace);\r\n            var val;\r\n            var fUpdate = function() { return subLocation.install(val); };\r\n            var thiz = this;\r\n            this.updater = onChange(function() { val = obj(thiz.host, thiz); }, fUpdate);\r\n            fUpdate();\r\n        } else if (obj && obj.then instanceof Function) {\r\n            obj.then(val => this.installChild(val, this.host, this.namespace), console.error);\r\n        } else if (obj && obj.toContent instanceof Function) {\r\n            var cont = obj.toContent();     // no input of host so as not to cause confusion w/ function content mechanics\r\n            this.installChild(cont, this.host, this.namespace);\r\n        } else {\r\n            this.ele = document.createTextNode(obj.toString());\r\n            this.host.insertBefore(this.ele, this.getElementAfter());\r\n            console.log('Unexpected content type - using toString');     // todo: remove?\r\n        }\r\n        \r\n        this.occupant = obj;\r\n    }\r\n\r\n    clear() {\r\n        if (this.hasBeenRemoved)\r\n            //console.log('already removed');     // todo: really need to remove this\r\n            throw Error('already removed');\r\n\r\n        // stop update events from triggering\r\n        if (this.updater)\r\n            this.updater.cancel();\r\n            \r\n        // remove any child locations\r\n        this.forEach(function(loc) { \r\n            loc.remove();\r\n        });\r\n        \r\n        // remove element if location is hosting a simple literal\r\n        if (this.ele) {\r\n            this.host.removeChild(this.ele);\r\n            this.ele = null;\r\n        } else if (this.installedContent)\r\n            this.clearedAgain = true;\r\n    }\r\n\r\n    remove() {        // removes the location from the dom, along with anything in it\r\n        this.clear();\r\n        LinkedTree.prototype.remove.call(this);\r\n        this.hasBeenRemoved = true;\r\n        if (this.fallbackEnder)\r\n            this.host.removeChild(this.fallbackEnder);\r\n    };\r\n}","\r\nimport HtmlLocation from './locations/htmllocation.js';\r\n\r\n\r\nexport default function install(obj, host, before) {\r\n    if (typeof host === 'string')\r\n        host = document.getElementById(host);\r\n        \r\n    var loc = new HtmlLocation(undefined, host, before);\r\n    loc.install(obj);    \r\n    \r\n    return loc;\r\n}\r\n","\r\nexport default (function() {\r\n    function on(name, callback) {\r\n        return function(el) {\r\n            return el.addEventListener(name, callback);\r\n        };\r\n    };\r\n\r\n    var eventNames = [\r\n        'click', 'contextmenu', 'dblclick', 'mousedown', 'mouseenter', 'mouseleave', 'mousemove', 'mouseover', 'mouseout', 'mouseup',\r\n        /*'keydown', 'keypress', 'keyup',*/     // handled elsewhere\r\n        'abort', 'load', 'scroll',\r\n        'blur', 'change', 'focus', 'focusin', 'focusout', 'input', 'invalid', 'reset', 'search', 'select', 'submit',\r\n        'drag', 'dragend', 'dragenter', 'dragleave', 'dragover', 'dragstart', 'drop',\r\n        'copy', 'cut', 'paste',\r\n        'animationend', 'animationiteration', 'animationstart',\r\n        'transitionend',\r\n        'show', 'toggle', 'wheel'\r\n    ];\r\n    var evFunc = name => action => el => el.addEventListener(name, action);\r\n    for (var i=0; i<eventNames.length; i++) {\r\n        var name = eventNames[i];\r\n        on[name] = evFunc(name);\r\n    }\r\n\r\n    // todo: implement scroll\r\n    on.wheel.down = function wheelDown(callback) {\r\n        return on.wheel(function(ev) {\r\n            ev.preventDefault();\r\n            if (ev.wheelDelta < 0)\r\n                callback(ev);\r\n        });\r\n    };\r\n    on.wheel.up = function wheelUp(callback) { \r\n        return on.wheel(function(ev) {\r\n            ev.preventDefault();\r\n            if (ev.wheelDelta > 0)\r\n                callback(ev);\r\n        });\r\n    };\r\n\r\n    // keystroke sugar:\r\n    //  on.keydown.g(ev => console.log('you pressed g!'));\r\n    //  on.keydown.ctrl.s(functionThatSavesMyStuff)(document.body);\r\n\r\n    var chars;\r\n    var otherKeys;\r\n    function loadKeyNames(evName, evSetup) {\r\n        if (!chars) {\r\n            chars = [];\r\n            for (var i=0 ; i<230 ; i++) {\r\n                var char = String.fromCharCode(i);\r\n                if (char.length != \"\")\r\n                    chars.push(char);\r\n            }\r\n        }\r\n        if (!otherKeys)\r\n            otherKeys = {\r\n                //shift:16, ctrl:17, alt:18,\r\n                backspace:8, tab:9, enter:13, pause:19, capsLock:20, escape:27,\r\n                pageUp:33, pageDown:34, end:35, home:36, left:37, up:38, right:39, down:40,\r\n                insert:45, delete:46, \r\n                leftWindow:91, rightWindow:92, select:93, \r\n                f1:112, f2:113, f3:114, f4:115, f5:116, f6:117, f7:118, f8:119, f9:120, f10:121, f11:122, f12:123, \r\n                numLock:144, scrollLock:145\r\n            };\r\n\r\n        Object.keys(otherKeys).forEach(function(keyName) {\r\n            evSetup[keyName] = function(callback) {\r\n                return evSetup(function(ev) {\r\n                    if (otherKeys[keyName] === ev.which) {\r\n                        ev.preventDefault();\r\n                        callback(ev); \r\n                    }\r\n                });\r\n            };\r\n        });\r\n        \r\n        function setupChars(obj, test) {\r\n            chars.forEach(function(char) {\r\n                obj[char] = function(callback) { \r\n                    return evSetup(function(ev) {\r\n                        if ((!test || test(ev)) && String.fromCharCode(ev.which).toLowerCase() === char) {\r\n                            ev.preventDefault();\r\n                            callback(ev); \r\n                        }\r\n                    });\r\n                };\r\n            });\r\n        }\r\n\r\n        function setupModKey(key, test) {\r\n            lazyProperty(evSetup, key, function() {\r\n                var out = function(callback) {\r\n                    return evSetup(function(ev) {\r\n                        if (otherKeys[keyName] === ev.which) {\r\n                            ev.preventDefault();\r\n                            callback(ev); \r\n                        }\r\n                    });\r\n                };\r\n                setupChars(out, test);\r\n                return out;\r\n            });\r\n        }\r\n        \r\n        setupChars(evSetup);\r\n        setupModKey('ctrl', function(ev) { return ev.ctrlKey || ev.metaKey; });\r\n        setupModKey('shift', function(ev) { return ev.shiftKey; });\r\n        setupModKey('alt', function(ev) { return ev.altKey; });\r\n    };\r\n\r\n    function lazyProperty(obj, prop, initialize) {\r\n        if (Object.defineProperty) {\r\n            Object.defineProperty(obj, prop, {\r\n                enumerable: true,\r\n                configurable: true,\r\n                get: function() {\r\n                    var value = initialize.apply(this);\r\n                    Object.defineProperty(obj, prop, {\r\n                        enumerable: true,\r\n                        configurable: true,\r\n                        value: value\r\n                    });\r\n                    return value;\r\n                }\r\n            });\r\n        } else {\r\n            obj[prop] = initialize.apply(obj);\r\n        }\r\n    }\r\n\r\n    ['keydown', 'keyup', 'keypress'].forEach(function(evName) {\r\n        lazyProperty(on, evName, function() {\r\n            var out = function(callback) {\r\n                return on(evName, callback);\r\n            };\r\n            loadKeyNames(evName, out);\r\n            return out;\r\n        });\r\n    });\r\n\r\n    return on;\r\n})();","\r\nfunction eventTrigger(thiz) {\r\n    var counter = 1;\r\n    var out = function(callback) {\r\n        var id = counter++;\r\n        out.dependents[id] = callback;\r\n        out.remove = function() {\r\n            delete out.dependents[id];\r\n        };\r\n    };\r\n    out.trigger = function() {\r\n        var args = arguments;\r\n        Object.keys(out.dependents).forEach(function(key) {\r\n            var callback = out.dependents[key];\r\n            callback.apply(thiz, args);\r\n        });\r\n    };\r\n    out.dependents = {};\r\n\r\n    return out;\r\n}\r\n\r\nexport function alertArray(arr) {\r\n    if (!arr.onRemove) {\r\n        arr.onRemove = eventTrigger(arr);\r\n        arr.onInsert = eventTrigger(arr);\r\n\r\n        var push = arr.push;\r\n        arr.push = function(val) {\r\n            var out = push.call(arr, val);\r\n            arr.onInsert.trigger(val, arr.length);\r\n            return out;\r\n        };\r\n\r\n        var pop = arr.pop;\r\n        arr.pop = function() {\r\n            var out = pop.apply(arr);\r\n            arr.onRemove.trigger(arr.length - 1);\r\n            return out;\r\n        };\r\n\r\n        var shift = arr.shift;\r\n        arr.shift = function() {\r\n            var out = shift.apply(arr);\r\n            arr.onRemove.trigger(0);\r\n            return out;\r\n        };\r\n\r\n        var unshift = arr.unshift;\r\n        arr.unshift = function(val) {\r\n            var out = unshift.call(arr, val);\r\n            arr.onRemove.trigger(val, 0);\r\n            return out;\r\n        };\r\n\r\n        var splice = arr.splice;\r\n        arr.splice = function(pos, deleteCount) {\r\n            pos = pos.valueOf(); \r\n            var out = splice.apply(arr, arguments);\r\n            while (deleteCount > 0) {\r\n                arr.onRemove.trigger(pos + deleteCount - 1);\r\n                deleteCount--;\r\n            }\r\n            for (var i=2; i<arguments.length; i++) {\r\n                var item = arguments[i];\r\n                arr.onInsert.trigger(item, pos + i - 2);\r\n            }\r\n            return out;\r\n        };\r\n    }\r\n};\r\n\r\nexport function bindMap(arr, transform) {\r\n    function posGetter(val) {\r\n        var out = function getPos() {\r\n            for (var i=0; i<arr.length; i++)\r\n                if (val === arr[i])\r\n                    return i;\r\n        };\r\n        out.valueOf = out;\r\n        return out;\r\n    };\r\n\r\n    // map via for loop to prevent undesired change detection\r\n    var out = [];\r\n    for (var i=0; i<arr.length; i++) {\r\n        var item = arr[i];\r\n        var tItem = transform(item, posGetter(item), arr);\r\n        out.push(tItem);\r\n    }\r\n\r\n    alertArray(arr);\r\n    arr.onRemove(function(pos) {\r\n        return out.splice(pos, 1);\r\n    });\r\n    arr.onInsert(function(item, pos) {\r\n        var tItem = transform(item, posGetter(item), arr);\r\n        return out.splice(pos, 0, tItem);\r\n    });\r\n\r\n    return out;\r\n};\r\n\r\nexport function arrInstall(arr) {\r\n    alertArray(arr);\r\n    var initialized = false;\r\n    var installations = [];\r\n\r\n    return function(el, loc) {\r\n        if (!initialized) {\r\n            initialized = true;\r\n\r\n            arr.onRemove(function(pos) {\r\n                arr;\r\n                var inst = installations[pos];\r\n                inst.remove();\r\n                installations.splice(pos, 1);\r\n            });\r\n            arr.onInsert(function(item, pos) {\r\n                arr;\r\n                var instPos = installations[pos];\r\n                var inst;\r\n                if (instPos)\r\n                    inst = instPos.insertContent(item);\r\n                else\r\n                    inst = loc.installChild(item, el);\r\n                installations.splice(pos, 0, inst);\r\n            });\r\n\r\n            arr.forEach(function(item) {\r\n                var inst = loc.installChild(item, el);\r\n                installations.push(inst);\r\n            });\r\n        }\r\n    };\r\n};\r\n\r\n\r\nexport default function map(arr, transform) {\r\n    return arrInstall(bindMap(arr, transform));\r\n};","\r\nimport {obs, install, bundle, on, map} from '../exports.js';\r\n\r\n\r\nclass MyClass {\r\n    constructor(message) {\r\n        this.message = message || 'No message entered';\r\n    }\r\n    toContent() {\r\n        return this.message;\r\n    }\r\n}\r\n\r\n\r\nvar state = {};             // an object we'll attach mutable values to\r\nobs(state, 'text');         // let the change detector know the text property of the state object is mutable\r\nobs(state, 'keystroke');\r\n\r\n\r\nvar content = bundle        // the bundle template literal tag is used to create markup content\r\n    `<h3>Text: ${() => state.text}</h3>\r\n    <input type=\"text\" ${on.input(ev => state.text = ev.target.value)} />\r\n\r\n    <h3>Array</h3>\r\n    <ol>\r\n        ${map([1,2,3], (n, i, arr) => bundle\r\n            `<li>\r\n                <button ${on.click(ev => arr.splice(i, 0, Math.random()))}>+</button>\r\n                <button ${on.click(ev => arr.splice(i, 1))}>-</button>\r\n                ${n}\r\n            </li>`\r\n        )}\r\n    </ol>\r\n    \r\n    <h3>Promise</h3>\r\n    <div>\r\n        ${new Promise(function(resolve, reject) {\r\n            setTimeout(() => resolve('Three seconds have passed!'), 3000);\r\n        })}\r\n    </div>\r\n\r\n    <h3>Custom Object Rendering</h3>\r\n    ${new MyClass('this is a custom object rendering')}\r\n    \r\n    <h3>Keystroke Listeners</h3>\r\n    Try pressing backspace, s, or shift-s!\r\n    <div>${() => state.keystroke && `You pressed ${state.keystroke}!`}</div>`;\r\n\r\non.keyup.backspace(() => state.keystroke = 'backspace')(document);\r\non.keydown.s(() => state.keystroke = 's')(document);\r\non.keydown.shift.s(() => state.keystroke = 'shift-s')(document);\r\n\r\n\r\ninstall(content, document.body);\r\n"],"names":["counter","newId","invalidate","obj","deps","dependents","cache","undefined","keys","forEach","key","onInvalidate","currentDependent","onInvalidateQueue","push","re","arg1","arg2","arg3","arg4","getterSetter","Object","defineProperty","Error","Array","isArray","arrayProperty","relativeProperty","alerterProperty","Function","relativeGetterSetter","out","get","id","value","set","arrayFuncNotifiers","arrayGetterSetter","arr","_reProxy","getValueLocation","i","length","insertBeforeValue","item","positionValue","splice","removeValue","method","func","apply","arguments","getter","setter","oldDependent","err","queue","onChange","trigger","callback","gs","continues","onChangeCallback","cancelOnChange","_funcNotifiers","fName","prop","LinkedTree","parent","lt","last","itemAfter","itemBefore","first","wasAfter","wasBefore","thiz","child","next","call","Bundle","args","strings","bundle","CompiledHtmlAttribute","name","bounder","host","map","o","evaluate","join","result","toString","compileAttribute","cursor","isComplete","attrName","attrBounder","tc","thisChar","step","valueLoc","getStringCursor","nameCollection","collectStaticsThrough","staticsCollection","attrValue","compileAttributes","attrs","ca","attr","CompiledHtmlElement","attributes","contents","compileElement","tagStart","tagName","substring","tagAttrs","tagEnding","terminator","string","innards","compileHtml","closeTag","closeTagName","Cursor","b","stringCursor","charCursor","thisString","ts","thisItem","remainingStrings","cc","Math","max","j","terminators","includeTerminator","rs","firstTerminator","t","loc","indexOf","location","finalChar","piece","charCodes","charFromHtmlCode","code","ele","document","createElement","innerHTML","innerText","compiledBundles","getCompiledHtmlBundle","sig","JSON","stringify","html","nodes","externalEndingDetected","simpleNodes","n","matches","match","replace","node","AttributeLocation","index","Element","install","updater","val","getName","setAttribute","getValue","cancel","HtmlLocation","before","namespace","comesBefore","fallbackEnder","createComment","nodeName","appendChild","fe","getFirstElement","sibling","getElementAfter","content","createChild","ns","insert","clear","installedContent","createTextNode","insertBefore","installChild","chtml","createElementNS","attrsLocation","parentElement","log","removeChild","subLocation","fUpdate","then","console","error","toContent","cont","occupant","hasBeenRemoved","remove","clearedAgain","prototype","getElementById","on","el","addEventListener","eventNames","evFunc","action","wheel","down","wheelDown","ev","preventDefault","wheelDelta","up","wheelUp","chars","otherKeys","loadKeyNames","evName","evSetup","char","String","fromCharCode","tab","enter","pause","capsLock","escape","pageDown","end","home","left","right","delete","rightWindow","select","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","scrollLock","keyName","which","setupChars","test","toLowerCase","setupModKey","ctrlKey","metaKey","shiftKey","altKey","lazyProperty","initialize","eventTrigger","alertArray","onRemove","onInsert","pop","shift","unshift","pos","deleteCount","valueOf","bindMap","transform","posGetter","getPos","tItem","arrInstall","initialized","installations","inst","instPos","insertContent","MyClass","message","state","obs","text","input","target","click","random","Promise","resolve","reject","keystroke","keyup","backspace","keydown","s","body"],"mappings":"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"}